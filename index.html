<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>AI Cat ‚Äì Emotional Companion</title>

<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

<!-- MediaPipe -->
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_detection/face_detection.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<style>
body { background:#f8fafc; overflow:hidden; }
#cat { transition: transform .5s ease; transform-origin: bottom center; }
.emotion-happy #cat { transform: translateY(-8px) scale(1.03); }
.emotion-sad #cat { transform: translateY(8px) scale(.97); opacity:.85 }
.emotion-shy #cat { transform: rotate(-6deg) scale(.96); }
.emotion-sulk #cat { transform: rotate(6deg) translateY(6px); }
.emotion-sleep #cat { animation: breathe 2s infinite; opacity:.8 }
@keyframes breathe { 50% { transform: scale(1.02) } }
</style>
</head>

<body class="flex flex-col items-center justify-center h-screen">

<!-- CAMERA -->
<video id="camera" autoplay playsinline class="hidden"></video>

<!-- HEADER -->
<div class="absolute top-4 flex gap-2">
<select id="personality" class="p-2 rounded-xl bg-indigo-100 text-xs font-bold">
<option value="cute">üò∫ Cute</option>
<option value="sarcastic">üòº Sarcastic</option>
<option value="wise">üßô Wise</option>
</select>
</div>

<!-- CAT -->
<svg id="cat" viewBox="0 0 200 200" width="320">
<circle cx="100" cy="110" r="70" fill="#6366f1"/>
<circle cx="80" cy="100" r="6" fill="#111"/>
<circle cx="120" cy="100" r="6" fill="#111"/>
<ellipse cx="100" cy="135" rx="12" ry="2" fill="#111"/>
</svg>

<!-- SPEECH -->
<div class="bg-white p-4 rounded-2xl shadow-xl text-center max-w-sm">
<p id="aiText" class="font-semibold text-gray-700">Hello! I'm alive now üòº</p>
<p id="bnText" class="text-sm italic text-gray-500 mt-1">‡¶Ü‡¶Æ‡¶ø ‡¶è‡¶ñ‡¶® ‡¶ú‡ßÄ‡¶¨‡¶®‡ßç‡¶§‡•§</p>
</div>

<!-- CONTROLS -->
<div class="mt-4 flex gap-3">
<button onclick="pet()" class="bg-white px-4 py-2 rounded-full shadow">ü§≤ Pet</button>
<button onclick="scold()" class="bg-white px-4 py-2 rounded-full shadow">‚òùÔ∏è Scold</button>
</div>

<!-- XP -->
<div class="absolute bottom-4 bg-indigo-100 px-4 py-1 rounded-full text-xs font-bold">
XP: <span id="xp">0</span> | Level <span id="lvl">1</span>
</div>

<script>
/* ================= STATE ================= */
const STATE = {
xp: Number(localStorage.getItem("xp")||0),
level: Number(localStorage.getItem("level")||1),
mood: localStorage.getItem("mood")||"neutral",
personality: "cute"
};

/* ================= MEMORY ================= */
function saveMemory(){
localStorage.setItem("xp",STATE.xp);
localStorage.setItem("level",STATE.level);
localStorage.setItem("mood",STATE.mood);
}

/* ================= XP SYSTEM ================= */
function addXP(v){
STATE.xp+=v;
if(STATE.xp>STATE.level*10){
STATE.level++;
}
saveMemory();
updateUI();
}

/* ================= EMOTIONS ================= */
function emotion(e){
document.body.className="";
document.body.classList.add("emotion-"+e);
STATE.mood=e;
saveMemory();
}

/* ================= ACTIONS ================= */
function pet(){
emotion("happy");
addXP(2);
talk("I like that. You're gentle.","‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ñ‡ßÅ‡¶¨ ‡¶Ü‡¶¶‡ßÅ‡¶∞‡ßá‡•§");
}
function scold(){
emotion("sulk");
addXP(-1);
talk("Hey‚Ä¶ that hurt.","‡¶ì‡¶ü‡¶æ ‡¶ï‡¶∑‡ßç‡¶ü ‡¶¶‡¶ø‡¶≤‡•§");
}

/* ================= AI SPEECH (STATIC DEMO) ================= */
function talk(en,bn){
document.getElementById("aiText").innerText=en;
document.getElementById("bnText").innerText=bn;
speechSynthesis.cancel();
let u=new SpeechSynthesisUtterance(en);
u.lang="en-US";
speechSynthesis.speak(u);
}

/* ================= FACE DETECTION ================= */
function initFace(){
const face=new FaceDetection({locateFile:f=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_detection/${f}`});
face.setOptions({minDetectionConfidence:.6});
face.onResults(res=>{
if(res.detections.length>0){
emotion("shy");
}else{
emotion("sleep");
}
});
new Camera(document.getElementById("camera"),{
onFrame:async()=>{await face.send({image:camera});},
width:320,height:240
}).start();
}

/* ================= INIT ================= */
function updateUI(){
document.getElementById("xp").innerText=STATE.xp;
document.getElementById("lvl").innerText=STATE.level;
}
document.getElementById("personality").onchange=e=>{
STATE.personality=e.target.value;
talk("I feel different now.","‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶Æ‡¶® ‡¶¨‡¶¶‡¶≤‡ßá ‡¶ó‡ßá‡¶õ‡ßá‡•§");
};
updateUI();
document.body.addEventListener("click",initFace,{once:true});
</script>

</body>
</html>
